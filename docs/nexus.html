<html><head><!-- #include file=":INCLUDE:head.html" --><link rel="stylesheet" href="manual.css" type="text/css"><meta name="author" content="J. L. Thorley and Mark Wilkinson" ><meta name="copyright" content="2000, 2001, J. L. Thorley and Mark Wilkinson" ><!-- /#include --><meta name="robots" content="noindex" ><meta name="description" content="The RadCon Manual: NEXUS Format"><meta name="keywords" content="radcon, manual, help, consensus, phylogenetic, tree, phylogeny, program, comparison, joe, thorley, rod, page, radical, leaf stability"><title> NEXUS Format (The RadCon Manual) </title></head><!-- #include file=":INCLUDE:start.html" --><body bgcolor="#ffffff"><h4 align="right"><font color="#800000">(The RadCon Manual v1.1.2)</font></h4><!-- /#include --><hr><h2>NEXUS Format</h2><hr><p>The NEXUS format is a format for storing phylogenetic information, including trees, morphological characters and nucleotide sequences. </p><p>RadCon can <a href="input.html" class="internal">input</a> trees stored in the NEXUS format.</p><a name="nexus format"></a><hr><h2>NEXUS Format</h2><p>The NEXUS format is formally described by <A HREF="references.html#maddison:etal:1997:nexus" class = "internal">Maddison et al. (1997)</A>. Further information is also available from the <A HREF="http://phylogeny.arizona.edu/nexus/nexus.html" class = "external">NEXUS</A> webpage.</p><a name="a nexus tree file"></a><hr><h2>A NEXUS Tree File</h2><p><p>The essential feature of the NEXUS format is themodularisation of the phylogenetic information.</p><p>A NEXUS file is divided into one or more <A HREF="#blocks" class = "internal">blocks</A> which house different kinds of phylogeneticinformation. The blocks are composed of a series of <A HREF="#commands" class = "internal">commands</A> and the commandscomposed of a series of <A HREF="#tokens" class = "internal">tokens</A>. </p><p>Modularisation facilitatesboth the sharing of files between programs and the extension of the format as the skipping of irrelevant or unrecognised blocks, commands or tokens is a simple operation.</p><p>Another feature of the NEXUS format is case insensitivity which means that all <A HREF="#tokens" class = "internal">tokens</A>, except names, with the samesequence of characters are equivalent irrespective of case. Thus, for example, the <A HREF="#begin token" class = "internal">BEGIN</A> token can be written <B>BEGIN</B> or <B>begin</B>.</p><p>An example NEXUS tree file</p><TABLE CELLPADDING=2 CELLSPACING=0 WIDTH=0 BORDER=0 BGCOLOR="#FFFFE1"><TR><TD><PRE>#NEXUS[This is a comment. It is for you not RadCon]begin taxa;    dimensions ntax = 11;    taxlabels leaf_a leaf_b leaf_c leaf_d leaf_e leaf_f leaf_g leaf_h leaf_i leaf_j leaf_k;endblock;BEGIN TREES;    TREE tree1 = [&R] [&W 1] ((leaf_e,(leaf_d,(leaf_c,(leaf_b,leaf_a)))),(leaf_f,(leaf_g,(leaf_h,(leaf_i,(leaf_j,leaf_k))))));END;BEGIN TREES;    TRANSLATE     1 leaf_a,     2 leaf_b,     3 leaf_c,     4 leaf_d,     5 leaf_e,     6 leaf_f,     7 leaf_g,     8 leaf_h,     9 leaf_i,    ten leaf_j,    eleven leaf_k;    TREE tree1 = ((leaf_e,(leaf_d,(leaf_c,(leaf_b,leaf_a)))),(leaf_f,(leaf_g,(leaf_h,(leaf_i,(leaf_j,leaf_k))))));    TREE tree1 = [&R] [&W 1] ((5,(4,(3,(2,1)))),(6,(7,(8,(9,(ten,eleven))))));END;</PRE></TD></TR></TABLE><p>This NEXUS file consists of a <A HREF="#comments" class = "internal">comment</A>, a <A HREF="#taxa block" class = "internal">TAXA</A> block, which is in lower case, and<A HREF="#predefined leaves" class = "internal">predefines</A> 11 <ahref="terms.html#leaf" class="internal">leaves</a> and two <A HREF="#trees block" class = "internal">TREES</A> block, which are in upper case, and between them contain three trees (each tree is defined by a single <A HREF="#tree command" class = "internal">TREE</A> command). The three trees are identical. They both have the name 'tree1', are <A HREF="#tree rooting" class = "internal">rooted</A>, have a <A HREF="#tree weighting" class = "internal">weight</A> of 1 and posit the same set of cladistic relationships for the 11 leaves. The <A HREF="#tree descriptions" class = "internal">tree descriptions</A> differ in appearance because the first tree in the second TREES block refers to the leaves by the arbitrary tokens defined in the <A HREF="#translate command" class = "internal">TRANSLATE</A> commandwhile the two other tree descriptions refer to the leaves by name. </p><p>When presented with <A HREF="#multiple trees blocks" class = "internal">multiple TREES blocks</A> phylogenetic programs typically only read in the trees stored in one of the TREES block, RadCon reads in all the trees, treating them as constituting a single set of trees or multiple sets of trees. </p><a name="predefined leaves"></a><hr><h2>Predefined Leaves</h2><p>The NEXUS standard is for the leaves to be predefined in a <A HREF="#taxa block" class = "internal">TAXA</A>or DATA block and the trees in succeeding <A HREF="#trees block" class = "internal">TREES</A> block to contain all and only these leaves. </p><p>In RadCon this standard can be relaxed and trees permitted to have <A HREF="#missing leaves" class = "internal">missing</A> or <A HREF="#undefined leaves" class = "internal">undefined</A>leaves.</p><p> RadCon is unable to read DATA blocks. A TREES block with no TAXA block  can be input to RadCon if undefined leaves are permitted.</p><a name="missing leaves"></a><hr><h2>Missing Leaves</h2><p>RadCon does not require trees to have the complete complement of <AHREF="#predefined leaves" class = "internal">predefined</A> leaves. </p><p>This allows trees withnon-identical leaf sets to be input and allows the production of supertrees.</p><p>If any predefined leaves are missing from all the trees they are listed in the Log window anddeleted from memory. </p><a name="undefined leaves"></a><hr><h2>Undefined Leaves</h2><p>If trees have leaves that were not <A HREF="#predefined leaves" class = "internal">predefined</A> RadCon either 1) treats this as an <A HREF="input.html#input error" class = "internal">input error</A> or 2) redefines the leaf set 'on the fly' to include them. </p><p>The adopted protocol for handling undefined leaves can be set using the Preferences option in the Edit menu.</p><p>Allowing the leaf set to be redefined 'on the fly'  makes the <A HREF="#taxa block" class = "internal">TAXA</A> or DATA block unnecessary(although the presence of the TAXA block may effect the ordering of leaves in memory) and facilitates the production of supertrees as it allows <A HREF="#tree command" class = "internal">TREE</A> commands from different files to be pasted into a single <A HREF="#trees block" class = "internal">TREES</A> block. </p><a name="tree descriptions"></a><hr><h2>Tree Descriptions</h2><p>Tree descriptions describe the structure of trees.</p><p>The NEXUS format adopts the <A HREF="newick.html" class = "internal">Newick</A> format for storing tree descriptions.</p><a name="tree names"></a><hr><h2>Tree Names</h2><p>The second <A HREF="#tokens" class = "internal">token</A> in the <A HREF="#tree command" class = "internal">TREE</A> command defines a trees name.</p><a name="tree rooting"></a><hr><h2>Tree Rooting</h2><p>The presence of the [&R] or [&U] rooting <AHREF="#command comments" class = "internal">command comment</A> in the <A HREF="#tree command" class = "internal">TREE</A> command indicates if the tree is <ahref="terms.html#root" class="internal">rooted or unrooted</a>, respectively. </p><p>The rooting command comment must directly precede the <A HREF="#tree descriptions" class = "internal">tree description</A>.</p><p>If no rooting command comment is present the tree is rooted or unrooted if the first token in the TREE command is TREE orUTREE, respectively.</p><a name="tree weighting"></a><hr><h2>Tree Weighting</h2><p>The weight of a tree is specified by a <A HREF="#command comments" class = "internal">command comment</A> of the form [&W 1] in the <A HREF="#tree command" class = "internal">TREE</A> command.</p><p>The weighting command comment must directly precede the <A HREF="#tree descriptions" class = "internal">tree description</A>.</p><p>If no weighting command comment is present the tree is assigned the default weight of 1.</p><a name="default tree"></a><hr><h2>Default Tree</h2><p>The '*' character in the <A HREF="#tree command" class = "internal">TREE</A> command designates a tree the default tree.</p><p>The default tree is the tree viewed in the Tree Window.</p><a name="multiple trees blocks"></a><hr><h2>Multiple TREES Blocks</h2><p>Multiple <A HREF="nexus.html#trees block" class = "internal">TREES</A> blocks are treated as constituting either separate sets of trees or a single set of trees. </p><p>The adopted protocolcan be set using the Preferences option in the Edit menu. </p><p>If multiple TREES blocks are treated as constituting a single set of trees then each time a <A HREF="nexus.html#taxa block" class = "internal">TAXA</A> block is encountered the leaf set is redefined to include any new leaves.</p><p>If multiple TREES blocks are taken to constitute separate sets of trees then each time a TAXA block is encountered thecurrent set of leaves is reset. </p>RadCon's response to the presence of <A HREF="#undefined leaves" class = "internal">undefined leaves</A> is independentof its treatment of multiple TREES blocks. If undefined leaves are added to the current leaf set 'on the fly' then the presence of TAXA blocks is effectively irrelevant (although it may affect the ordering of leaf names in memory).</p><p>Although undefined leaves in a <A HREF="#translate command" class = "internal">TRANSLATE</A> command can be added to the current leaf set 'on the fly', the correspondence between arbitrary labels and leaves defined by each TRANSLATE command is only valid in the TREES block containing the TRANSLATE command.  </p><a name="nexus command"></a><hr><h2>#NEXUS</h2><p>The first <A HREF="#tokens" class = "internal">token</A> in a NEXUS file must be </p><p><B>#NEXUS</B></p><a name="tokens"></a><hr><h2>Tokens</h2><p>A NEXUS file consists of a series of tokens. </p><p>A token is a word, i.e. series of charactersseparated by whitespace, or a <A HREF="#punctuation characters" class = "internal">punctuation character</A>. </p><p>Examples include the <A HREF="#begin token" class = "internal">BEGIN</A> and <AHREF="#semicolon token" class = "internal">semicolon</A> tokens.</p><p>Tokens are arranged according to a predefined syntax(see <A HREF="references.html#maddison:etal:1997:nexus" class = "internal">Maddison et al.</A>, 1997)to produce a series of <A HREF="#commands" class = "internal">commands</A>. </p><a name="punctuation characters"></a><hr><h2>Punctuation Characters</h2><p>There are 10 special characters ';,():=[]&*' which are treated as <A HREF="#tokens" class = "internal">tokens</A> and provide punctuation in NEXUS files.</p><a name="commands"></a><hr><h2>Commands</h2><p><A HREF="#tokens" class = "internal">Tokens</A> are arranged according to a predefined syntax(see <A HREF="references.html#maddison:etal:1997:nexus" class = "internal">Maddison et al.</A>, 1997)to produce a series of commands. <p>A command begins with a token specifying the name of the command and is terminated with the <AHREF="#semicolon token" class = "internal">semicolon token</A> <A HREF="#punctuation characters" class = "internal">punctuation character</A>.</p><p>Examples include the <A HREF="#begin command" class = "internal">BEGIN</A>, <A HREF="#endblock command" class = "internal">ENDBLOCK</A>, <A HREF="#translate command" class = "internal">TRANSLATE</A> and <A HREF="#tree command" class="internal">TREE</A> commands.</p><p>Commands are arranged according to a predefined syntax (see <A HREF="references.html#maddison:etal:1997:nexus" class = "internal">Maddison et al.</A>, 1997)to produce one or more <A HREF="#blocks" class = "internal">blocks</A>. </p><a name="blocks"></a><hr><h2>Blocks</h2><p><A HREF="#commands" class = "internal">Commands</A> are arranged according to a predefined syntax (see <A HREF="references.html#maddison:etal:1997:nexus" class = "internal">Maddison et al.</A>, 1997)to produce one or more blocks. </p><p>The start of a block is indicated by the <A HREF="#begin command" class = "internal">BEGIN</A> command.</p><p>The termination of a block is indicated by the <A HREF="#endblock command" class = "internal">ENDBLOCK</A> command.</p><p>Examples include the <A HREF="#taxa block" class = "internal">TAXA</A>, <A HREF="#trees block" class = "internal">TREES</A>, DATA and CHARACTERS blocks.</p><p>The blocks store different kinds of phylogenetic information.</p><a name="comments"></a><hr><h2>Comments</h2><p>Comments can be added to NEXUS files by enclosing text within the <A HREF="#punctuation characters" class = "internal">punctuation characters</A> [ and ].</p><p>Comments, with the exception of <A HREF="#command comments" class = "internal">command comments</A>, provide information for the user not the program.</p><a name="command comments"></a><hr><h2>Command Comments</h2><p>Command comments are <A HREF="#comments" class = "internal">comments</A> which provide phylogenetic information for programs.</p><p>Command comments have the & <A HREF="#punctuation characters" class = "internal">punctuation character</A> at the start of the commented text, i.e., [& commented text].</p><p>Examples include the <A HREF="#tree rooting" class = "internal">tree rooting</A> and <AHREF="#tree weighting" class = "internal">tree weighting</A> command comments.</p><a name="begin token"></a><hr><h2>BEGIN token</h2><p>The BEGIN <A HREF="#tokens" class = "internal">token</A> <p><B>BEGIN</B> </p>indicates the start of a <A HREF="#begin command" class = "internal">BEGIN</A> command.</p><a name="semicolon token"></a><hr><h2>Semicolon token</h2><p>The semicolon <A HREF="#tokens" class = "internal">token</A></p><p><B>;</B> </p>indicates the end of a <A HREF="#commands" class = "internal">command</A>.</p><p>The semicolon token is a <A HREF="#punctuation characters" class = "internal">punctuation character</A>.</p><a name="begin command"></a><hr><h2>BEGIN Command</h2><p>The BEGIN <A HREF="#commands" class = "internal">command</A> indicates the start of a <A HREF="#blocks" class = "internal">block</A>.</p>A BEGIN command is of the form <p><B>BEGIN <I>NAME_OF_BLOCK</I>;</B></p>where the second <A HREF="#tokens" class = "internal">token</A> specifys the type of the block. <p>Examples include the the <A HREF="#taxa block" class = "internal">TAXA</A>, <A HREF="#trees block" class = "internal">TREES</A>, DATA and CHARACTERS blocks.</p><a name="endblock command"></a><hr><h2>ENDBLOCK Command</h2><p>The ENDBLOCK <A HREF="#commands" class = "internal">command</A></p><p><B>ENDBLOCK;</B></p><p>which can be shortened to</p><p><B>END;</B></p>indicates the termination of a <A HREF="#blocks" class = "internal">block</A>.</p><a name="dimensions command"></a><hr><h2>DIMENSIONS Command</h2><p>The DIMENSIONS <A HREF="#commands" class = "internal">command</A> is <A HREF="#taxa block" class = "internal">TAXA</A> block command that specifies the number of leaves <A HREF="#predefined leaves" class = "internal">defined</A> in the TAXA block. </p><p>An example DIMENSIONS command</p><p><B>DIMENSIONS NTAX=10;</B></p><p>This DIMENSIONS command indicates that the TAXA block will define 10 leaves.</p><a name="taxlabels command"></a><hr><h2>TAXLABELS Command</h2><p>The TAXLABELS <A HREF="#commands" class = "internal">command</A> is <A HREF="#taxa block" class = "internal">TAXA</A> block command that specifies the names of the leaves <A HREF="#predefined leaves" class = "internal">defined</A> in the TAXA block. </p><p>The leaf names must be <A HREF="input.html#leaf names" class = "internal">valid</A> and unique.</p><p>An example TAXLABELS command</p><p><B>TAXLABELS Fulmarus_glacialis, Calonectris_diomedea, Puffinus_puffinus, Puffinus_yelkouan;</B></p><p>This TAXLABELS command specifies the names of four leaves.</p><a name="tree command"></a><hr><h2>TREE Command</h2><p>The TREE <A HREF="#commands" class = "internal">command</A> is a <A HREF="#trees block" class = "internal">TREES</A> block command that specifies the <A HREF="#tree names" class = "internal">name</A>, <AHREF="#tree rooting" class = "internal">rooting</A>, <A HREF="#tree weighting" class = "internal">weight</A> and <A HREF="#tree descriptions" class = "internal">structure</A> of onetree. </p><p>An example TREE command</p><p><b>TREE tree1 = [&R] [&W 1/5] (((Puffinus_puffinus,Puffinus_yelkouan),Calonectris_diomedea),Fulmarus_glacialis);<br></b></p><p>This TREE command specifies that the tree structure defined by the <AHREF="#tree descriptions" class = "internal">tree description</A> is rooted, has a weight of 0.2 and has the name tree1.</p><a name="translate command"></a><hr><h2>TRANSLATE Command</h2><p>The TRANSLATE <A HREF="#commands" class = "internal">command</A> is an optional <A HREF="#trees block" class = "internal">TREES</A> block command. It informs a program of arbitrary labels that may be used to represent leaves in the <AHREF="#tree descriptions" class = "internal">tree descriptions</A>. These labels are often integers and this standard was introduced toallow a reduction in the size of tree descriptions. </p><p>An example TRANSLATE command</p><p><b>TRANSLATE<br>  1   Fulmarus_glacialis,<br>  2   Calonectris_diomedea,<br>  5   Puffinus_puffinus,<br>  yel Puffinus_yelkouan;<br></b></p>This TRANSLATE command indicates that the leaves Fulmarus_glacialis, Calonectris_diomedea etcmay also be referred to by the labels 1, 2 etc, respectively, in the tree descriptions in the TREES block.</p><a name="taxa block"></a><hr><h2>TAXA Block</h2><p>The TAXA <A HREF="#blocks" class = "internal">block</A> stores information about leaves (taxa). A TAXA block must contain one <A HREF="#dimensions command" class = "internal">DIMENSIONS</A> command and one <A HREF="#taxlabels command" class = "internal">TAXLABELS</A> command in that order. The number of leaves specified by the DIMENSIONS command must correspond to the number of leaf names in the TAXLABELS command.</p><p>An example TAXA block</p><p><b>BEGIN TAXA;<br>DIMENSIONS NTAX = 4;<br>TAXLABELS Fulmarus_glacialis Calonectris_diomedea Puffinus_puffinus<br>Puffinus_yelkouan;<br>ENDBLOCK;</b></p><p>This TAXA block defines four leaves.</p><a name="trees block"></a><hr><h2>TREES Block</h2><p>The TREES <A HREF="#blocks" class = "internal">block</A> stores information about trees. A TREES block must contain at least one <A HREF="#tree command" class = "internal">TREE</A> commandand can contain a single optional <AHREF="#translate command" class = "internal">TRANSLATE</A> command which must precede the TREE commands.</p><p>An example TREES block</p><p><b>BEGIN TREES;<br>&nbsp; TRANSLATE<br>&nbsp;  1   Fulmarus_glacialis,<br>&nbsp;  2   Calonectris_diomedea,<br>&nbsp;  5   Puffinus_puffinus,<br>&nbsp;  yel Puffinus_yelkouan;<br>TREE tree1 = [&R] [&W 1/5] (((Puffinus_puffinus,Puffinus_yelkouan),Calonectris_diomedea),Fulmarus_glacialis);<br>TREE tree2 = (((5,yel),2),1);<br>ENDBLOCK;<br></b></p><p>This TREES block specifies two trees. Structurally the trees are identical, although the <A HREF="#tree descriptions" class = "internal">tree descriptions</A> differ. This is because the first tree description refers to the leaves by their actual names whilst the second tree description refers to the leaves by their corresponding labels defined by the TRANSLATE command. </p><!-- #include file=":INCLUDE:gototoc.html" --><hr><br><p>Go to the <a href="manual.html#contents" class="internal">Table of Contents</a>.</p><!-- /#include --><hr><br><!-- #lastmodified text="This page was last modified" form="long" -->This page was last modified May 3, 2001<!-- /#lastmodified --></p><!-- #include file=":INCLUDE:end.html" --><p>This page is maintained by <a HREF="mailto:joe@poissonconsulting.ca" class="external">joe@poissonconsulting.ca</a></p><hr><br><p>&#169; Copyright 1999, 2000, 2001, Joseph L. Thorley and Mark Wilkinson. All rights reserved.</p><hr><!-- /#include --></body></html>